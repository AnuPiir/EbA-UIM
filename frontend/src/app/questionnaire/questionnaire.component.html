<mat-spinner *ngIf="loading"></mat-spinner>
<div class="projects-wrapper">
    <div class="add-project" (click)="!isToggled && toggleAddNewQuestionnaire()" role="button"
         [attr.aria-expanded]="isToggled"
         tabindex="0"
         (keydown.enter)="!isToggled && toggleAddNewQuestionnaire()"
         (keydown.space)="!isToggled && toggleAddNewQuestionnaire()">
        <div class="add-project-header">
            <h2>{{'addProject.title' | translate}}</h2>
            <button *ngIf="!isToggled" (click)="toggleAddNewQuestionnaire(); $event.stopPropagation()" class="button-icon">
                <span class="material-symbols-outlined icon">expand_more</span>
            </button>
            <button *ngIf="isToggled" type="button" (click)="toggleAddNewQuestionnaire(); $event.stopPropagation()" class="button-icon"
                    (keydown.enter)="toggleAddNewQuestionnaire(); $event.stopPropagation()"
                    (keydown.space)="toggleAddNewQuestionnaire(); $event.stopPropagation()">
                <span class="material-symbols-outlined icon">expand_less</span>
            </button>
        </div>
        <div *ngIf=isToggled class="add-project-row" (click)="$event.stopPropagation()">
            <div class="add-project-input">
                <h3>{{'addProject.input' | translate}}</h3>
                <input placeholder="{{'addProject.placeholder' | translate}}" id="questionnaireName" type="text" [(ngModel)]="questionnaireName" />
            </div>
            <div class="add-project-buttons">
                <button (click)="toggleAddNewQuestionnaire(); $event.stopPropagation()" class="button cancel-button">{{'button.cancel' | translate}}</button>
                <button [disabled]="questionnaireName.length <= 0" (click)="addNewQuestionnaire(questionnaireName); $event.stopPropagation()" formtarget="_blank" class="button add-button">{{'button.add' | translate}}</button>
            </div>
        </div>
        <div *ngIf="isToggled" class="add-project-row import-row" (click)="$event.stopPropagation()">
            <div class="import-project-button">
                <button (click)="importProject(); $event.stopPropagation()" class="button blue">
                    {{ 'button.import' | translate }}
                </button>
            </div>
        </div>
    </div>
    <div class="projects-table">
        <table *ngIf="!loading && questionnaires.length > 0">
            <thead>
            <tr>
                <th class="projects-table-head">
                    <h2>{{'projectsTable.title' | translate}}</h2>
                </th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let questionnaire of questionnaires" class="projects-table-row">
                <td class="project-cell">
                    <span>{{questionnaire.name}}</span>
                    <a [routerLink]="validationPath" [queryParams]="{questionnaireId: questionnaire.id}" class="see-more-button">{{'projectsTable.seeMore' | translate}}</a>
                    <p>{{ questionnaire.lastModified | date: 'dd.MM.yyyy HH:mm' : 'et-EE' }}</p>
                </td>
                <td class="action-button-cell">
                    <app-menu [toggle]="'Menu'" [icon]="menuIcon" [actions]="getActions(questionnaire)"></app-menu>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>